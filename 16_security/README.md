# Reentrancy

pull метод

Атакуемый контракт при вызове метода вывода средств, не успевает выполнить всю логику метода. Т.к. после отправки средств получателю он снова получает вызов метода вывода средств. Процесс продалжается пока на контракте есть средства.
Для выполнения атаки атакующий контракт, в методе receive() снова вызвыает метод refund() в атакуемом контракте.

# DoS

push метод выплат

Атакуемый контракт делает выплаты в цикле. Атакующий контракт вноситсредства на атакуемый контракт. Атакующий контракт может не иметь метода receive(). В таком случае метода возврата средств будет прерывать высов метода возврата каждый раз из-за отсутствия возможности вернуть средства на атакующий контракт.
Или атакующий контракт может иметь внутри метод receive() но его выполнение может быть временно заблокировано. Атакующий будет управлять поведением метода receive() атакующего контракта из вне.

Решение:
- заменить подход к выплатам push на pull.
- не блокировать выполнение метода вызовом require(). В случае если выплата на адрес не удалась - отложить этот адрес в другой массив
- запретить делать ставки со смарт контрактов. Это требование сложно в реализации.
```
require(msg.sender.code.length == 0, "no contracts");
```